---
layout:     post
title:      PIMC
subtitle:   Understanding the Success of Perfect Information Monte Carlo Sampling in Game Tree Search
date:       2020-04-13 12:00:00
author:     "tengshiquan"
header-img: "img/post-bg-dice.jpg"
catalog: true
tags:
    - AI
    - MCTS
    - Game Theory 
    - Imperfect Information
    - Alberta

---



# PIMC

todo



## Understanding the Success of Perfect Information Monte Carlo Sampling in Game Tree Search

2010  from Alberta



### Abstract

完美信息蒙特卡罗(PIMC)搜索是一种用于imperfect信息博弈的实用技术，这种game规模很大,很难得到最优解。尽管PIMC搜索在过去曾因其理论上的缺陷而饱受批评，但在实践中，它往往在不同的领域中产生了很好的结果。在本文中，我们试图解决这一矛盾。这篇论文的贡献有两个方面。首先，我们使用合成synthetic博弈树来确定PIMC搜索的博弈属性，这些属性会导致PIMC搜索的性能强或弱于最优玩家。其次，我们展示了这些属性如何在真实的游戏中被检测出来，并证明这些属性似乎是PIMC搜索强度的良好预测因素。因此，使用本文建立的工具，应该可以先验地决定PIMC搜索是否是解决新游戏的有效方法。



### Introduction

Imperfect information的理想的解决方案，至少对于双人零和游戏来说，是使用一种能够产生纳什均衡Nash equilibrium的求解技术，保证对完美对手的完美博弈。然而，这在所有的游戏中，除了最简单的游戏，在计算上是不可行的。

**从imperfect采样perfect** :  处理不完美信息的一种流行的方法是回避这个问题。用取样的方式来代替求解一个完整的游戏，从游戏中抽取perfect信息world，然后用精确或启发式的方式求解。这种方法也被称为**完美信息蒙特卡洛(PIMC)**. 

该方法在桥牌(Ginsberg 2001)游戏中培养出了专家级的棋手。然而，这项工作经常因为回避信息不完善的问题而受到批评。例如，Russell和Norvig（Russell和Norvig 2002）在他们的AI教科书的第二版中写道，PIMC搜索（他们称之为 "**averaging over clairvoyancy 洞察上平均**"）在他们提出的一个简单的例子中提出了一个 "没有一个理智的人会遵循 "的行动路线。

我们假设，应该有少量的简明属性，可以描述一个博弈树的一般属性，并从这些属性来衡量PIMC作为一种方法是否可能成功。我们提出了几个属性，并用来构建可以被解决的小合成树，也可以用PIMC进行博弈。我们表明，这些属性直接影响PIMC的性能，并且可以在真实的游戏中进行测量。因此，我们能够证明，在许多类游戏中，PIMC与游戏理论解相比，不会有很大的损失。



### Background and Related Work

PIMC 搜索的第一个成功应用,  GIB , 打桥牌.  1998.   然后通过alpha-beta 改进 PIMC. 

1998年，Frank和Basin发表了一篇关于不完全信息博弈的PIMC方法的广泛批评。他们表明，PIMC搜索的性质使其容易出现两种不同类型的错误，而不论研究的假设世界hypothetical worlds的数量如何。其中第一种错误被称为**策略融合strategy fusion**。策略融合的产生是因为PIMC搜索（错误地）认为它可以在每个世界中使用不同的策略，而在现实中，有一些情况（或信息集）是由多个完美信息情景组成的。在full imperfect信息博弈中，**玩家无法区分这些情境，必须在每个情境中选择相同的策略；但PIMC搜索错误地认为，它可以根据每个情境选择适合每个情境的策略。**

我们用图1(a)来说明策略融合。最大化玩家被表示为一个向上指向的三角形，最小化玩家被表示为一个向下的三角形。终端节点为正方形，其下边的最大玩家的报酬率为正方形。有两个世界是由树中位置较高的概率节点创建的。我们假设两个玩家都不知道他们是在世界1还是世界2，所以我们不在树上显示这个信息。

<img src="2020-04-13-PIMC.assets/image-20200430002406009.png" alt="image-20200430002406009" style="zoom:50%;" />

在根节点，最大化玩家可以选择向右移动到节点(c)，无论在哪个世界，都可以保证获得1的回报。最大化玩家也可以从世界1中标有(a)的节点和世界2中标有(b)的节点获得1的回报。PIMC搜索会认为它总是能在节点(a)和(b)以上的节点上做出正确的决策，所以在根部的这两步棋看起来都是赢。但实际上，最大的玩家在世界1和世界2之间混淆了，实际上可能会在树的左侧出现歧义错误。我们注意到，要使策略融合实际上造成PIMC搜索的下法错误，需要两个条件。第一，树的一部分上必须有相关性相反的值的棋子（节点（a）和（b））；第二，树的另一部分上必须有保证好的棋子。如果节点(c)的值为-1，PIMC搜索将做出正确的决定，尽管它将高估树的值。



第二个错误被称为 **非本地性*non-locality***。非本地性是由于在一个完美的信息博弈中，博弈树节点的值仅是其子树的函数，因此一个节点的值完全由从子树开始的搜索决定。在一个不完美的信息博弈中，一个节点的价值可能取决于博弈树中不包含在其子树中的其他区域，这主要是由于对手能够利用他所掌握而我们不知道的私人信息，将博弈引导到他知道（或至少是猜测）对他有利的区域。这种现象在树上潜在的远处节点之间产生了非本地依赖关系。

<img src="2020-04-13-PIMC.assets/image-20200430012845082.png" alt="image-20200430012845082" style="zoom:50%;" />

我们在图1(b)中说明了非本地性。在这个图中，树的顶部有一个机会节点。最大化的玩家知道概率节点的动作，但最小化的玩家无法区分虚线矩形内的状态。在这棵树中，PIMC搜索将为最小化玩家做一个随机动作。但是，事实上，最小化玩家总是可以知道正确的下法。因为如果可能的话，最大化玩家会在世界1中取胜，而最小化玩家只有在世界2中才会有机会赢，这时最大化玩家会向左移动以避免立即损失。因此，最小化玩家可以推断出正确的世界和正确的行动。

虽然我们不会在我们的博弈模型中明确地创建这些结构，但我们将能够调整这些结构发生的概率，PIMC搜索将被混淆。我们还可以测量这种情况在实际的博弈树中出现的频率。



#### Domains

本文中我们使用了两个说明性的领域。第一个是一类基于技巧的纸牌游戏。这个领域的精确规则对我们的目的并不重要，但这个领域中的动作是重要的。在一个基于技巧的纸牌游戏中，一个动作是将自己手中的一张牌朝上打到桌子上。这有两方面的意义。第一，当行动发生时，信息被泄露，信息集被分割。第二，有很多可能的合法行动。大多数西方游戏使用52张牌，在游戏树的每个节点上最多允许52个可能的行动。欧洲的一些纸牌游戏使用的是32张短牌，导致每个状态下最多可以有32个动作。

我们研究的第二个领域是扑克。同样的，扑克有很多变种，我们在这里就不讨论了。重要的是，扑克中的行动（下注、加注、跟注、弃牌）的数量是有限的，而且行动不会直接揭示任何隐藏的信息。因此，扑克中每个信息集中的真实游戏状态的数量不会随着玩家在游戏中的行动而改变。

在2003年至2010年期间，可解的扑克牌游戏树的大小增长了5个数量级，从$10^7$个状态（Billings等人，2003年）到$10^12$个状态（Zinkevich等人，2008年）。最近的收获是Counter-factual Regret算法(CFR)(Zinkevich等人，2008年)的结果，该算法能够在空间上近似求解与信息集数量成正比的博弈，在时间上$O(I^2N)$，其中I是信息集数量，N是博弈状态数。



#### Further Motivation













### Reference


## Reference

Understanding the Success of Perfect Information Monte Carlo Sampling in Game Tree Search  https://www.cs.du.edu/~sturtevant/papers/pimc.pdf



















